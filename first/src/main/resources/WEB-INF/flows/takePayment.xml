<view-state id="takePayment" model="flowScope.paymentDetails">
    <action-state id="saveOrder">
        <evalutate expression="pizzaFlowActions.saveOrder(order)"/>
        <transition to="thankYou"/>
    </action-state>
    <decision-state id="checkDeliveryArea">
        <if test="pizzaFlowActions.checkDeliberyArea(customer.zipCode)"
            then="addCustomer"
            else="deliveryWarning"/>
    </decision-state>
    <subflow-state id="order" subflow="pizza/order">
        <input name="order" value="order"/>
        <transition on="orderCreated" to="payment"/>
    </subflow-state>
    <end-state id="customerReady" />
</view-state>